/* ==========================================================================
   3D Dice - Proper Polyhedra with Numbered Faces
   Each die shows all faces with numbers, tumbles, and lands on result
   ========================================================================== */

:root {
  --dice-transition: 0.3s ease-out;
  --face-font: 'Segoe UI', system-ui, sans-serif;
}

/* --------------------------------------------------------------------------
   Container Setup
   -------------------------------------------------------------------------- */

.dice-container {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  align-items: center;
  gap: 30px;
  perspective: 800px;
  min-height: 180px;
  padding: 20px;
}

/* --------------------------------------------------------------------------
   Base 3D Die Wrapper
   -------------------------------------------------------------------------- */

.die-3d {
  position: relative;
  transform-style: preserve-3d;
  transition: transform var(--dice-transition);
}

.die-3d.rolling {
  animation: dice-tumble var(--roll-duration, 1.8s) cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
  animation-delay: var(--animation-delay, 0s);
}

.die-shape {
  width: 100%;
  height: 100%;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  transform-style: preserve-3d;
}

/* Base face styling - all faces have numbers */
.die-3d .face {
  position: absolute;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: var(--face-font);
  font-weight: 700;
  backface-visibility: visible;
  box-sizing: border-box;
}

/* ==========================================================================
   D6 - CUBE (6 square faces with pips)
   The classic - pips instead of numbers
   ========================================================================== */

.die-d6 {
  width: 60px;
  height: 60px;
}

.die-d6 .die-shape {
  width: 60px;
  height: 60px;
}

.die-d6 .face {
  width: 60px;
  height: 60px;
  background: linear-gradient(145deg, #e83a53, #c41e3a);
  border: 2px solid rgba(255,255,255,0.3);
  border-radius: 8px;
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-template-rows: repeat(3, 1fr);
  padding: 8px;
  gap: 2px;
  box-shadow: inset 0 2px 4px rgba(255,255,255,0.2), inset 0 -2px 4px rgba(0,0,0,0.3);
}

.die-d6 .pip {
  width: 12px;
  height: 12px;
  background: radial-gradient(circle at 30% 30%, #ffffff, #d0d0d0);
  border-radius: 50%;
  box-shadow: inset -1px -1px 2px rgba(0,0,0,0.2), 0 1px 2px rgba(0,0,0,0.3);
  justify-self: center;
  align-self: center;
}

/* D6 face positions - opposite faces sum to 7 */
.die-d6 .face-1 { transform: translateZ(30px); }
.die-d6 .face-6 { transform: rotateY(180deg) translateZ(30px); }
.die-d6 .face-2 { transform: rotateX(-90deg) translateZ(30px); }
.die-d6 .face-5 { transform: rotateX(90deg) translateZ(30px); }
.die-d6 .face-3 { transform: rotateY(-90deg) translateZ(30px); }
.die-d6 .face-4 { transform: rotateY(90deg) translateZ(30px); }

/* Pip positions */
.die-d6 .face-1 .pip { grid-area: 2 / 2; }

.die-d6 .face-2 .pip:nth-child(1) { grid-area: 1 / 3; }
.die-d6 .face-2 .pip:nth-child(2) { grid-area: 3 / 1; }

.die-d6 .face-3 .pip:nth-child(1) { grid-area: 1 / 3; }
.die-d6 .face-3 .pip:nth-child(2) { grid-area: 2 / 2; }
.die-d6 .face-3 .pip:nth-child(3) { grid-area: 3 / 1; }

.die-d6 .face-4 .pip:nth-child(1) { grid-area: 1 / 1; }
.die-d6 .face-4 .pip:nth-child(2) { grid-area: 1 / 3; }
.die-d6 .face-4 .pip:nth-child(3) { grid-area: 3 / 1; }
.die-d6 .face-4 .pip:nth-child(4) { grid-area: 3 / 3; }

.die-d6 .face-5 .pip:nth-child(1) { grid-area: 1 / 1; }
.die-d6 .face-5 .pip:nth-child(2) { grid-area: 1 / 3; }
.die-d6 .face-5 .pip:nth-child(3) { grid-area: 2 / 2; }
.die-d6 .face-5 .pip:nth-child(4) { grid-area: 3 / 1; }
.die-d6 .face-5 .pip:nth-child(5) { grid-area: 3 / 3; }

.die-d6 .face-6 .pip:nth-child(1) { grid-area: 1 / 1; }
.die-d6 .face-6 .pip:nth-child(2) { grid-area: 1 / 3; }
.die-d6 .face-6 .pip:nth-child(3) { grid-area: 2 / 1; }
.die-d6 .face-6 .pip:nth-child(4) { grid-area: 2 / 3; }
.die-d6 .face-6 .pip:nth-child(5) { grid-area: 3 / 1; }
.die-d6 .face-6 .pip:nth-child(6) { grid-area: 3 / 3; }

/* ==========================================================================
   D4 - TETRAHEDRON (4 triangular faces)
   Numbers shown at corners/edges traditionally
   ========================================================================== */

.die-d4 {
  width: 70px;
  height: 70px;
}

.die-d4 .die-shape {
  width: 70px;
  height: 70px;
}

/* Tetrahedron geometry constants */
/* Edge length ~60px, height = edge * sqrt(2/3) ≈ 49px */
.die-d4 .face {
  width: 0;
  height: 0;
  border-left: 30px solid transparent;
  border-right: 30px solid transparent;
  border-bottom: 52px solid;
  left: 5px;
  top: 9px;
  font-size: 0; /* Hide text in triangle */
}

/* Number label for d4 - positioned at base of triangle */
.die-d4 .face::after {
  content: attr(data-value);
  position: absolute;
  bottom: -42px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 18px;
  font-weight: 700;
  color: white;
  text-shadow: 0 1px 2px rgba(0,0,0,0.5);
  font-family: var(--face-font);
}

/* Tetrahedron face positions - dihedral angle ≈ 70.53° */
.die-d4 .face-1 {
  border-bottom-color: #7b1fa2;
  transform: rotateY(0deg) rotateX(19.47deg) translateZ(15px);
}
.die-d4 .face-2 {
  border-bottom-color: #9c27b0;
  transform: rotateY(120deg) rotateX(19.47deg) translateZ(15px);
}
.die-d4 .face-3 {
  border-bottom-color: #8e24aa;
  transform: rotateY(240deg) rotateX(19.47deg) translateZ(15px);
}
.die-d4 .face-4 {
  border-bottom-color: #ab47bc;
  transform: rotateX(90deg) translateY(-17px) translateZ(-10px);
}

/* ==========================================================================
   D8 - OCTAHEDRON (8 triangular faces)
   Two square pyramids joined at base
   ========================================================================== */

.die-d8 {
  width: 60px;
  height: 60px;
}

.die-d8 .die-shape {
  width: 60px;
  height: 60px;
}

.die-d8 .face {
  width: 0;
  height: 0;
  border-left: 21px solid transparent;
  border-right: 21px solid transparent;
  left: 9px;
  top: 8px;
}

.die-d8 .face::after {
  content: attr(data-value);
  position: absolute;
  font-size: 14px;
  font-weight: 700;
  color: white;
  text-shadow: 0 1px 2px rgba(0,0,0,0.5);
  font-family: var(--face-font);
}

/* Top pyramid (faces point up) */
.die-d8 .face-1, .die-d8 .face-2, .die-d8 .face-3, .die-d8 .face-4 {
  border-bottom: 36px solid;
}
.die-d8 .face-1::after, .die-d8 .face-2::after, .die-d8 .face-3::after, .die-d8 .face-4::after {
  bottom: -30px;
  left: 50%;
  transform: translateX(-50%);
}

/* Bottom pyramid (faces point down) */
.die-d8 .face-5, .die-d8 .face-6, .die-d8 .face-7, .die-d8 .face-8 {
  border-top: 36px solid;
}
.die-d8 .face-5::after, .die-d8 .face-6::after, .die-d8 .face-7::after, .die-d8 .face-8::after {
  top: -30px;
  left: 50%;
  transform: translateX(-50%) rotate(180deg);
}

/* Octahedron positions - dihedral angle ≈ 109.47° */
.die-d8 .face-1 { border-bottom-color: #1b5e20; transform: rotateY(0deg) rotateX(35.26deg) translateZ(15px); }
.die-d8 .face-2 { border-bottom-color: #2e7d32; transform: rotateY(90deg) rotateX(35.26deg) translateZ(15px); }
.die-d8 .face-3 { border-bottom-color: #388e3c; transform: rotateY(180deg) rotateX(35.26deg) translateZ(15px); }
.die-d8 .face-4 { border-bottom-color: #43a047; transform: rotateY(270deg) rotateX(35.26deg) translateZ(15px); }
.die-d8 .face-5 { border-top-color: #4caf50; transform: rotateY(45deg) rotateX(144.74deg) translateZ(15px); }
.die-d8 .face-6 { border-top-color: #66bb6a; transform: rotateY(135deg) rotateX(144.74deg) translateZ(15px); }
.die-d8 .face-7 { border-top-color: #81c784; transform: rotateY(225deg) rotateX(144.74deg) translateZ(15px); }
.die-d8 .face-8 { border-top-color: #a5d6a7; transform: rotateY(315deg) rotateX(144.74deg) translateZ(15px); }

/* ==========================================================================
   D10 - PENTAGONAL TRAPEZOHEDRON (10 kite-shaped faces)
   Simplified as a decagonal bipyramid
   ========================================================================== */

.die-d10 {
  width: 60px;
  height: 60px;
}

.die-d10 .die-shape {
  width: 60px;
  height: 60px;
}

.die-d10 .face {
  width: 0;
  height: 0;
  border-left: 12px solid transparent;
  border-right: 12px solid transparent;
  left: 18px;
  top: 5px;
}

.die-d10 .face::after {
  content: attr(data-value);
  position: absolute;
  font-size: 12px;
  font-weight: 700;
  color: white;
  text-shadow: 0 1px 2px rgba(0,0,0,0.5);
  font-family: var(--face-font);
  left: 50%;
  transform: translateX(-50%);
}

/* Top faces */
.die-d10 .face-0, .die-d10 .face-1, .die-d10 .face-2, .die-d10 .face-3, .die-d10 .face-4 {
  border-bottom: 25px solid;
}
.die-d10 .face-0::after, .die-d10 .face-1::after, .die-d10 .face-2::after,
.die-d10 .face-3::after, .die-d10 .face-4::after {
  bottom: -22px;
}

/* Bottom faces */
.die-d10 .face-5, .die-d10 .face-6, .die-d10 .face-7, .die-d10 .face-8, .die-d10 .face-9 {
  border-top: 25px solid;
}
.die-d10 .face-5::after, .die-d10 .face-6::after, .die-d10 .face-7::after,
.die-d10 .face-8::after, .die-d10 .face-9::after {
  top: -22px;
  transform: translateX(-50%) rotate(180deg);
}

/* D10 colors and positions - 36° increments */
.die-d10 .face-0 { border-bottom-color: #e65100; transform: rotateY(0deg) rotateX(40deg) translateZ(18px); }
.die-d10 .face-1 { border-bottom-color: #ef6c00; transform: rotateY(72deg) rotateX(40deg) translateZ(18px); }
.die-d10 .face-2 { border-bottom-color: #f57c00; transform: rotateY(144deg) rotateX(40deg) translateZ(18px); }
.die-d10 .face-3 { border-bottom-color: #fb8c00; transform: rotateY(216deg) rotateX(40deg) translateZ(18px); }
.die-d10 .face-4 { border-bottom-color: #ff9800; transform: rotateY(288deg) rotateX(40deg) translateZ(18px); }
.die-d10 .face-5 { border-top-color: #ffa726; transform: rotateY(36deg) rotateX(140deg) translateZ(18px); }
.die-d10 .face-6 { border-top-color: #ffb74d; transform: rotateY(108deg) rotateX(140deg) translateZ(18px); }
.die-d10 .face-7 { border-top-color: #ffcc80; transform: rotateY(180deg) rotateX(140deg) translateZ(18px); }
.die-d10 .face-8 { border-top-color: #ffa726; transform: rotateY(252deg) rotateX(140deg) translateZ(18px); }
.die-d10 .face-9 { border-top-color: #ffb74d; transform: rotateY(324deg) rotateX(140deg) translateZ(18px); }

/* ==========================================================================
   D12 - DODECAHEDRON (12 pentagonal faces)
   ========================================================================== */

.die-d12 {
  width: 70px;
  height: 70px;
}

.die-d12 .die-shape {
  width: 70px;
  height: 70px;
}

.die-d12 .face {
  width: 32px;
  height: 30px;
  background: #00838f;
  clip-path: polygon(50% 0%, 100% 38%, 81% 100%, 19% 100%, 0% 38%);
  font-size: 14px;
  color: white;
  text-shadow: 0 1px 2px rgba(0,0,0,0.5);
  left: 19px;
  top: 20px;
  padding-top: 8px;
}

/* Dodecahedron - dihedral angle ≈ 116.57° */
/* Top cap */
.die-d12 .face-1 { background: #006064; transform: rotateX(90deg) translateZ(22px); }
/* Top ring */
.die-d12 .face-2 { background: #00838f; transform: rotateY(0deg) rotateX(26.57deg) translateZ(28px); }
.die-d12 .face-3 { background: #0097a7; transform: rotateY(72deg) rotateX(26.57deg) translateZ(28px); }
.die-d12 .face-4 { background: #00acc1; transform: rotateY(144deg) rotateX(26.57deg) translateZ(28px); }
.die-d12 .face-5 { background: #00bcd4; transform: rotateY(216deg) rotateX(26.57deg) translateZ(28px); }
.die-d12 .face-6 { background: #26c6da; transform: rotateY(288deg) rotateX(26.57deg) translateZ(28px); }
/* Bottom ring */
.die-d12 .face-7 { background: #4dd0e1; transform: rotateY(36deg) rotateX(153.43deg) translateZ(28px); }
.die-d12 .face-8 { background: #00838f; transform: rotateY(108deg) rotateX(153.43deg) translateZ(28px); }
.die-d12 .face-9 { background: #0097a7; transform: rotateY(180deg) rotateX(153.43deg) translateZ(28px); }
.die-d12 .face-10 { background: #00acc1; transform: rotateY(252deg) rotateX(153.43deg) translateZ(28px); }
.die-d12 .face-11 { background: #00bcd4; transform: rotateY(324deg) rotateX(153.43deg) translateZ(28px); }
/* Bottom cap */
.die-d12 .face-12 { background: #006064; transform: rotateX(-90deg) translateZ(22px); }

/* ==========================================================================
   D20 - ICOSAHEDRON (20 triangular faces)
   The iconic d20 - 5 faces on top, 5 on bottom, 10 in middle
   ========================================================================== */

.die-d20 {
  width: 70px;
  height: 70px;
}

.die-d20 .die-shape {
  width: 70px;
  height: 70px;
}

.die-d20 .face {
  width: 0;
  height: 0;
  border-left: 18px solid transparent;
  border-right: 18px solid transparent;
  left: 17px;
  top: 12px;
}

.die-d20 .face::after {
  content: attr(data-value);
  position: absolute;
  font-size: 11px;
  font-weight: 700;
  color: white;
  text-shadow: 0 1px 2px rgba(0,0,0,0.5);
  font-family: var(--face-font);
  left: 50%;
  transform: translateX(-50%);
}

/* Top cap - 5 triangles pointing up */
.die-d20 .face-1, .die-d20 .face-2, .die-d20 .face-3, .die-d20 .face-4, .die-d20 .face-5 {
  border-bottom: 31px solid;
}
.die-d20 .face-1::after, .die-d20 .face-2::after, .die-d20 .face-3::after,
.die-d20 .face-4::after, .die-d20 .face-5::after {
  bottom: -26px;
}

/* Upper middle ring - 5 triangles pointing down */
.die-d20 .face-6, .die-d20 .face-7, .die-d20 .face-8, .die-d20 .face-9, .die-d20 .face-10 {
  border-top: 31px solid;
}
.die-d20 .face-6::after, .die-d20 .face-7::after, .die-d20 .face-8::after,
.die-d20 .face-9::after, .die-d20 .face-10::after {
  top: -26px;
  transform: translateX(-50%) rotate(180deg);
}

/* Lower middle ring - 5 triangles pointing up */
.die-d20 .face-11, .die-d20 .face-12, .die-d20 .face-13, .die-d20 .face-14, .die-d20 .face-15 {
  border-bottom: 31px solid;
}
.die-d20 .face-11::after, .die-d20 .face-12::after, .die-d20 .face-13::after,
.die-d20 .face-14::after, .die-d20 .face-15::after {
  bottom: -26px;
}

/* Bottom cap - 5 triangles pointing down */
.die-d20 .face-16, .die-d20 .face-17, .die-d20 .face-18, .die-d20 .face-19, .die-d20 .face-20 {
  border-top: 31px solid;
}
.die-d20 .face-16::after, .die-d20 .face-17::after, .die-d20 .face-18::after,
.die-d20 .face-19::after, .die-d20 .face-20::after {
  top: -26px;
  transform: translateX(-50%) rotate(180deg);
}

/* Icosahedron positions */
/* Top cap */
.die-d20 .face-1 { border-bottom-color: #1565c0; transform: rotateY(0deg) rotateX(20.9deg) translateZ(26px); }
.die-d20 .face-2 { border-bottom-color: #1976d2; transform: rotateY(72deg) rotateX(20.9deg) translateZ(26px); }
.die-d20 .face-3 { border-bottom-color: #1e88e5; transform: rotateY(144deg) rotateX(20.9deg) translateZ(26px); }
.die-d20 .face-4 { border-bottom-color: #2196f3; transform: rotateY(216deg) rotateX(20.9deg) translateZ(26px); }
.die-d20 .face-5 { border-bottom-color: #42a5f5; transform: rotateY(288deg) rotateX(20.9deg) translateZ(26px); }

/* Upper middle ring */
.die-d20 .face-6 { border-top-color: #1565c0; transform: rotateY(36deg) rotateX(58.28deg) translateZ(26px); }
.die-d20 .face-7 { border-top-color: #1976d2; transform: rotateY(108deg) rotateX(58.28deg) translateZ(26px); }
.die-d20 .face-8 { border-top-color: #1e88e5; transform: rotateY(180deg) rotateX(58.28deg) translateZ(26px); }
.die-d20 .face-9 { border-top-color: #2196f3; transform: rotateY(252deg) rotateX(58.28deg) translateZ(26px); }
.die-d20 .face-10 { border-top-color: #42a5f5; transform: rotateY(324deg) rotateX(58.28deg) translateZ(26px); }

/* Lower middle ring */
.die-d20 .face-11 { border-bottom-color: #64b5f6; transform: rotateY(0deg) rotateX(121.72deg) translateZ(26px); }
.die-d20 .face-12 { border-bottom-color: #90caf9; transform: rotateY(72deg) rotateX(121.72deg) translateZ(26px); }
.die-d20 .face-13 { border-bottom-color: #64b5f6; transform: rotateY(144deg) rotateX(121.72deg) translateZ(26px); }
.die-d20 .face-14 { border-bottom-color: #90caf9; transform: rotateY(216deg) rotateX(121.72deg) translateZ(26px); }
.die-d20 .face-15 { border-bottom-color: #64b5f6; transform: rotateY(288deg) rotateX(121.72deg) translateZ(26px); }

/* Bottom cap */
.die-d20 .face-16 { border-top-color: #bbdefb; transform: rotateY(36deg) rotateX(159.1deg) translateZ(26px); }
.die-d20 .face-17 { border-top-color: #90caf9; transform: rotateY(108deg) rotateX(159.1deg) translateZ(26px); }
.die-d20 .face-18 { border-top-color: #bbdefb; transform: rotateY(180deg) rotateX(159.1deg) translateZ(26px); }
.die-d20 .face-19 { border-top-color: #90caf9; transform: rotateY(252deg) rotateX(159.1deg) translateZ(26px); }
.die-d20 .face-20 { border-top-color: #bbdefb; transform: rotateY(324deg) rotateX(159.1deg) translateZ(26px); }

/* ==========================================================================
   D100 - Percentile Die (like D10 but shows 00-90)
   ========================================================================== */

.die-d100 {
  width: 60px;
  height: 60px;
}

.die-d100 .die-shape {
  width: 60px;
  height: 60px;
}

.die-d100 .face {
  width: 0;
  height: 0;
  border-left: 12px solid transparent;
  border-right: 12px solid transparent;
  left: 18px;
  top: 5px;
}

.die-d100 .face::after {
  content: attr(data-value);
  position: absolute;
  font-size: 10px;
  font-weight: 700;
  color: white;
  text-shadow: 0 1px 2px rgba(0,0,0,0.5);
  font-family: var(--face-font);
  left: 50%;
  transform: translateX(-50%);
}

/* Top faces */
.die-d100 .face-00, .die-d100 .face-10, .die-d100 .face-20, .die-d100 .face-30, .die-d100 .face-40 {
  border-bottom: 25px solid;
}
.die-d100 .face-00::after, .die-d100 .face-10::after, .die-d100 .face-20::after,
.die-d100 .face-30::after, .die-d100 .face-40::after {
  bottom: -22px;
}

/* Bottom faces */
.die-d100 .face-50, .die-d100 .face-60, .die-d100 .face-70, .die-d100 .face-80, .die-d100 .face-90 {
  border-top: 25px solid;
}
.die-d100 .face-50::after, .die-d100 .face-60::after, .die-d100 .face-70::after,
.die-d100 .face-80::after, .die-d100 .face-90::after {
  top: -22px;
  transform: translateX(-50%) rotate(180deg);
}

/* D100 colors - darker purple/bronze */
.die-d100 .face-00 { border-bottom-color: #4a148c; transform: rotateY(0deg) rotateX(40deg) translateZ(18px); }
.die-d100 .face-10 { border-bottom-color: #6a1b9a; transform: rotateY(72deg) rotateX(40deg) translateZ(18px); }
.die-d100 .face-20 { border-bottom-color: #7b1fa2; transform: rotateY(144deg) rotateX(40deg) translateZ(18px); }
.die-d100 .face-30 { border-bottom-color: #8e24aa; transform: rotateY(216deg) rotateX(40deg) translateZ(18px); }
.die-d100 .face-40 { border-bottom-color: #9c27b0; transform: rotateY(288deg) rotateX(40deg) translateZ(18px); }
.die-d100 .face-50 { border-top-color: #ab47bc; transform: rotateY(36deg) rotateX(140deg) translateZ(18px); }
.die-d100 .face-60 { border-top-color: #ba68c8; transform: rotateY(108deg) rotateX(140deg) translateZ(18px); }
.die-d100 .face-70 { border-top-color: #ce93d8; transform: rotateY(180deg) rotateX(140deg) translateZ(18px); }
.die-d100 .face-80 { border-top-color: #ab47bc; transform: rotateY(252deg) rotateX(140deg) translateZ(18px); }
.die-d100 .face-90 { border-top-color: #ba68c8; transform: rotateY(324deg) rotateX(140deg) translateZ(18px); }

/* ==========================================================================
   Tumbling Animation
   ========================================================================== */

@keyframes dice-tumble {
  0% {
    transform: translateY(-120px) translateZ(100px)
               rotateX(0deg) rotateY(0deg) rotateZ(0deg)
               scale(0.3);
    opacity: 0;
  }
  10% {
    opacity: 1;
    transform: translateY(-80px) translateZ(60px)
               rotateX(90deg) rotateY(45deg) rotateZ(30deg)
               scale(0.6);
  }
  30% {
    transform: translateY(-30px) translateZ(30px)
               rotateX(270deg) rotateY(180deg) rotateZ(90deg)
               scale(0.9);
  }
  50% {
    transform: translateY(10px) translateZ(10px)
               rotateX(450deg) rotateY(300deg) rotateZ(150deg)
               scale(1);
  }
  70% {
    transform: translateY(-5px) translateZ(5px)
               rotateX(600deg) rotateY(400deg) rotateZ(200deg)
               scale(1);
  }
  85% {
    transform: translateY(3px) translateZ(2px)
               rotateX(680deg) rotateY(450deg) rotateZ(220deg)
               scale(1);
  }
  100% {
    transform: translateY(0) translateZ(0)
               rotateX(var(--end-rx, 720deg))
               rotateY(var(--end-ry, 0deg))
               rotateZ(var(--end-rz, 0deg))
               scale(1);
    opacity: 1;
  }
}

/* Landing bounce */
@keyframes dice-land {
  0% { transform: translateY(0) rotateX(var(--end-rx, 0deg)) rotateY(var(--end-ry, 0deg)) rotateZ(var(--end-rz, 0deg)); }
  30% { transform: translateY(-8px) rotateX(var(--end-rx, 0deg)) rotateY(var(--end-ry, 0deg)) rotateZ(var(--end-rz, 0deg)); }
  60% { transform: translateY(0) rotateX(var(--end-rx, 0deg)) rotateY(var(--end-ry, 0deg)) rotateZ(var(--end-rz, 0deg)); }
  80% { transform: translateY(-3px) rotateX(var(--end-rx, 0deg)) rotateY(var(--end-ry, 0deg)) rotateZ(var(--end-rz, 0deg)); }
  100% { transform: translateY(0) rotateX(var(--end-rx, 0deg)) rotateY(var(--end-ry, 0deg)) rotateZ(var(--end-rz, 0deg)); }
}

.die-3d.landed {
  animation: dice-land 0.3s ease-out forwards;
  transform: rotateX(var(--end-rx, 0deg)) rotateY(var(--end-ry, 0deg)) rotateZ(var(--end-rz, 0deg));
}

/* ==========================================================================
   Result States
   ========================================================================== */

.die-3d.dropped {
  opacity: 0.4;
  filter: grayscale(80%);
  transform: scale(0.85) rotateX(var(--end-rx, 0deg)) rotateY(var(--end-ry, 0deg)) rotateZ(var(--end-rz, 0deg));
}

.die-3d.nat20 {
  filter: drop-shadow(0 0 15px #4ade80) drop-shadow(0 0 30px #22c55e);
}

.die-3d.nat1 {
  filter: drop-shadow(0 0 15px #f87171) drop-shadow(0 0 30px #ef4444);
}

@keyframes crit-glow {
  0%, 100% { filter: drop-shadow(0 0 15px currentColor) brightness(1); }
  50% { filter: drop-shadow(0 0 25px currentColor) brightness(1.15); }
}

.die-3d.nat20,
.die-3d.nat1 {
  animation: crit-glow 1.5s ease-in-out infinite;
}

/* ==========================================================================
   Reduced Motion
   ========================================================================== */

@media (prefers-reduced-motion: reduce) {
  .die-3d.rolling {
    animation: none;
    transform: rotateX(var(--end-rx, 0deg)) rotateY(var(--end-ry, 0deg)) rotateZ(var(--end-rz, 0deg));
  }

  .die-3d.nat20,
  .die-3d.nat1 {
    animation: none;
  }
}

/* ==========================================================================
   Mobile Responsive
   ========================================================================== */

@media (max-width: 768px) {
  .dice-container {
    gap: 20px;
    perspective: 600px;
    min-height: 140px;
    padding: 15px;
  }

  .die-d4 { width: 55px; height: 55px; }
  .die-d6 { width: 50px; height: 50px; }
  .die-d8 { width: 50px; height: 50px; }
  .die-d10 { width: 50px; height: 50px; }
  .die-d12 { width: 55px; height: 55px; }
  .die-d20 { width: 55px; height: 55px; }
  .die-d100 { width: 50px; height: 50px; }

  .die-d6 .face {
    width: 50px;
    height: 50px;
  }

  .die-d6 .face-1 { transform: translateZ(25px); }
  .die-d6 .face-6 { transform: rotateY(180deg) translateZ(25px); }
  .die-d6 .face-2 { transform: rotateX(-90deg) translateZ(25px); }
  .die-d6 .face-5 { transform: rotateX(90deg) translateZ(25px); }
  .die-d6 .face-3 { transform: rotateY(-90deg) translateZ(25px); }
  .die-d6 .face-4 { transform: rotateY(90deg) translateZ(25px); }

  .die-d6 .pip {
    width: 10px;
    height: 10px;
  }
}
